<!-- src/app/components/task-form/task-form.component.html -->

<div class="task-form-container">
  <h3>{{ task ? 'Modifier la tâche' : 'Nouvelle tâche' }}</h3>

  <form [formGroup]="taskForm" (ngSubmit)="onSubmit()">
    <!-- Titre -->
    <div class="form-group">
      <label for="title">Titre *</label>
      <input
        type="text"
        id="title"
        formControlName="title"
        placeholder="Ex: Terminer le rapport"
        class="form-control"
      />
      <div class="error-message" *ngIf="taskForm.get('title')?.invalid && taskForm.get('title')?.touched">
        <span *ngIf="taskForm.get('title')?.errors?.['required']">Le titre est requis</span>
        <span *ngIf="taskForm.get('title')?.errors?.['minlength']">
          Le titre doit contenir au moins 3 caractères
        </span>
      </div>
    </div>

    <!-- Description -->
    <div class="form-group">
      <label for="description">Description *</label>
      <textarea
        id="description"
        formControlName="description"
        placeholder="Décrivez votre tâche en détails..."
        class="form-control"
        rows="4"
      ></textarea>
      <div class="error-message" *ngIf="taskForm.get('description')?.invalid && taskForm.get('description')?.touched">
        <span *ngIf="taskForm.get('description')?.errors?.['required']">La description est requise</span>
        <span *ngIf="taskForm.get('description')?.errors?.['minlength']">
          La description doit contenir au moins 10 caractères
        </span>
      </div>
    </div>

    <!-- Priorité -->
    <div class="form-group">
      <label for="priority">Priorité *</label>
      <select
        id="priority"
        formControlName="priority"
        class="form-control"
      >
        <option *ngFor="let p of priorities" [value]="p">
          {{ p }} - {{ getPriorityLabel(p) }}
        </option>
      </select>
    </div>

    <!-- Date d'échéance -->
    <div class="form-group">
      <label for="dueDate">Date d'échéance *</label>
      <input
        type="date"
        id="dueDate"
        formControlName="dueDate"
        class="form-control"
      />
      <div class="error-message" *ngIf="taskForm.get('dueDate')?.invalid && taskForm.get('dueDate')?.touched">
        <span *ngIf="taskForm.get('dueDate')?.errors?.['required']">La date d'échéance est requise</span>
      </div>
    </div>

    <!-- Boutons -->
    <div class="form-actions">
      <button type="button" class="btn-secondary" (click)="onCancel()">
        Annuler
      </button>
      <button type="submit" class="btn-primary" [disabled]="taskForm.invalid">
        {{ task ? 'Modifier' : 'Ajouter' }}
      </button>
    </div>
  </form>
</div>
